digraph JaegerOAuth2ProxyArchitecture {
  rankdir=TB; // Top to Bottom layout

  // Internet
  subgraph cluster_internet {
    style=invis;
    Internet [shape=circle, label="Internet"];
  }

  // Ingress
  subgraph cluster_ingress {
    label = "K8s Ingress";
    Ingress [shape=box];
  }

  // oauth2-proxy
  subgraph cluster_oauth2_proxy {
    label = "oauth2-proxy";
    OAuth2Proxy [shape=box];
  }

  // Jaeger UI
  subgraph cluster_jaeger_ui {
    label = "Jaeger UI";
    JaegerUI [shape=box];
  }

  // Request Logging
  subgraph cluster_logging {
    label = "Request Logging";
    Logging [shape=box];
  }

  // Connections
  Internet -> Ingress [label="HTTP Request"];
  Ingress -> OAuth2Proxy [label="Authenticated Request"];
  OAuth2Proxy -> JaegerUI [label="Allowed Request"];
  OAuth2Proxy -> Logging [label="Audit Logging"];

  // Styling

  {rank=same; Ingress Internet;}

  // Hide box around subgraphs
  edge [style=invis];
  Internet -> Ingress [style=invis];
  Ingress -> OAuth2Proxy [style=invis];
  OAuth2Proxy -> JaegerUI [style=invis];
}
