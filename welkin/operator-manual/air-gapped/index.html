
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Welkin, the Kubernetes platform for software critical to our society
">
      
      
        <meta name="author" content="Elastisys AB">
      
      
        <link rel="canonical" href="https://elastisys.io/welkin/operator-manual/air-gapped/">
      
      
        <link rel="prev" href="../on-prem-standard/">
      
      
        <link rel="next" href="../configure/">
      
      
      <link rel="icon" href="https://elastisys.io/welkin/img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Air-gapped Network - Elastisys Welkin®</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../stylesheets/branding.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    

<!-- Matomo Tag Manager -->
<script>
  var _mtm = window._mtm = window._mtm || [];
  _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
  (function() {
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src='https://matomo.elastisys.com/js/container_fGrcdd2P.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Tag Manager -->


    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Air-gapped Network - Elastisys Welkin®" >
      
        <meta  property="og:description"  content="Documentation for Welkin, the Kubernetes platform for software critical to our society
" >
      
        <meta  property="og:image"  content="https://elastisys.io/welkin/assets/images/social/operator-manual/air-gapped.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://elastisys.io/welkin/operator-manual/air-gapped/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Air-gapped Network - Elastisys Welkin®" >
      
        <meta  name="twitter:description"  content="Documentation for Welkin, the Kubernetes platform for software critical to our society
" >
      
        <meta  name="twitter:image"  content="https://elastisys.io/welkin/assets/images/social/operator-manual/air-gapped.png" >
      
    
    
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  style-src 'self' 'unsafe-inline';
  img-src 'self' data:;
  connect-src 'self' https://matomo.elastisys.com/;
  script-src 'self' 'unsafe-inline' https://matomo.elastisys.com/;
">

<!-- Disable localStorage, sessionStorage and cookies -->
<script>
if (window.localStorage) {
  window.localStorage.setItem = function() { };
  window.localStorage.clear();
}
if (window.sessionStorage) {
  window.sessionStorage.setItem = function() { }
  window.sessionStorage.clear();
}
if(!document.__defineGetter__) {
  Object.defineProperty(document, 'cookie', {
    get: function(){return ''},
    set: function(){return true},
  });
} else {
  document.__defineGetter__("cookie", function() { return '';} );
  document.__defineSetter__("cookie", function() {} );
}
</script>

<!-- See https://realfavicongenerator.net/ -->
<link rel="icon" type="image/png" href="/welkin/img/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="/welkin/img/favicon.svg" />
<link rel="shortcut icon" href="/welkin/img/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="/welkin/img/apple-touch-icon.png" />
<link rel="manifest" href="/welkin/img/site.webmanifest" />

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="elastisys" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#welkin-in-air-gapped-network" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Elastisys Welkin®" class="md-header__button md-logo" aria-label="Elastisys Welkin®" data-md-component="logo">
      
  <img src="../../img/favicon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Elastisys Welkin®
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Air-gapped Network
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        

<ul class="header-links">
  <li>
    <a href="https://github.com/elastisys/welkin/">
      <img width="25px" src="../../img/git-alt.svg" alt="Git logo" />
    </a>
  </li>
  <li><a href="https://elastisys.com/" class="menu-callout">Try out Managed<br/>Welkin</a></li>
</ul>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          

  <!-- Navigation -->
  
    
    <div
      class="md-sidebar md-sidebar--primary"
      data-md-component="sidebar"
      data-md-type="navigation"
      
    >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Elastisys Welkin®" class="md-nav__button md-logo" aria-label="Elastisys Welkin®" data-md-component="logo">
      
  <img src="../../img/favicon.svg" alt="logo">

    </a>
    Elastisys Welkin®
  </label>
  
    <div class="md-nav__source">
      

<ul class="header-links">
  <li>
    <a href="https://github.com/elastisys/welkin/">
      <img width="25px" src="../../img/git-alt.svg" alt="Git logo" />
    </a>
  </li>
  <li><a href="https://elastisys.com/" class="menu-callout">Try out Managed<br/>Welkin</a></li>
</ul>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../mission-and-vision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mission and Vision
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For Application Developers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            For Application Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/understand-the-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understand the Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/prepare/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 1: Prepare
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 2: Deploy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/operate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step 3: Operate
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Go Deeper
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Go Deeper
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/prepare-application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prepare Your Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/prepare-idp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prepare Your Identity Provider (IdP)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Container registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/continous-development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Continuous Development
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPU
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/network-model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/kubernetes-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/kubernetes-ui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kubernetes UI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/namespaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Namespaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/log-based-alerts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Log-based Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/long-term-log-retention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Long-term Log Retention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/alerts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metric Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/maintenance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/ci-cd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI/CD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/demarcation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demarcation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/delegation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Delegate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/how-many-environments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How many environments?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/cluster-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Safeguards
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Safeguards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-no-root/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce No Root
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-podsecuritypolicies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce Restricted Privileges
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-networkpolicies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce NetworkPolicies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-trusted-registries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce Trusted Registries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-no-latest-tag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce No Latest Tag
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-job-ttl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce Job TTL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-no-load-balancer-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce No LoadBalancer Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/enforce-minimum-replicas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enforce Minimum Replicas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/default-pod-topology-spread-constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Default Pod Topology Spread Constraints
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional Services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Additional Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/additional-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/additional-services/postgresql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostgreSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/additional-services/timescaledb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TimescaleDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/additional-services/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/additional-services/rabbitmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RabbitMQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/additional-services/jaeger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jaeger (preview)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/additional-services/argocd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Argo CD (preview)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Self-Managed Services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Self-Managed Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/self-managed-services/ferretdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FerretDB (self-managed)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/self-managed-services/keycloak/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keycloak (self-managed)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/self-managed-services/jupyterhub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JupyterHub (self-managed)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/self-managed-services/sealedsecrets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SealedSecrets (self-managed)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/self-managed-services/mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB (self-managed)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/self-managed-services/sjunet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sjunet (self-managed)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/self-managed-services/flux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flux (self-managed)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/self-managed-services/kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kafka (self-managed)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/go-live/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Go-live Checklist
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For Platform Administrators
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            For Platform Administrators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understand-the-basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understand the Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../provider-audit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Provider Audit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../on-prem-standard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Standard Template for on-prem Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Air-gapped Network
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Air-gapped Network
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-context-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      System Context Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-air-gapped-welkin-apps" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Air-gapped Welkin Apps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Air-gapped Welkin Apps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container-images-and-registry-mirroring" class="md-nav__link">
    <span class="md-ellipsis">
      Container Images and Registry Mirroring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Container Images and Registry Mirroring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#migrating-images-from-a-running-environment-with-script" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating Images From a Running Environment with Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrating-images-manually" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating Images Manually
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-local-dns" class="md-nav__link">
    <span class="md-ellipsis">
      Node-local-dns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#falco" class="md-nav__link">
    <span class="md-ellipsis">
      Falco
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opensearch" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trivy" class="md-nav__link">
    <span class="md-ellipsis">
      Trivy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networkpolicies" class="md-nav__link">
    <span class="md-ellipsis">
      NetworkPolicies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-alerting-receiver" class="md-nav__link">
    <span class="md-ellipsis">
      Custom alerting receiver
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo" class="md-nav__link">
    <span class="md-ellipsis">
      Demo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced Configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Advanced Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-sizing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sizing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ingress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingress
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access-control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../opensearch-mappings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenSearch Mappings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-alerts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-managed-crds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Managed CRDs (preview)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../disaster-recovery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disaster Recovery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../break-glass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Breaking the Glass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cryptography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use of Cryptography
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use of Credentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../capacity-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Capacity Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clock-synchronization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clock Synchronization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maintenance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clean-up/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clean Up
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Additional Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_19" >
        
          
          <label class="md-nav__link" for="__nav_4_19" id="__nav_4_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuration Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_19">
            <span class="md-nav__icon md-icon"></span>
            Configuration Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Index
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schema/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../schema/secrets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For CISOs and DPOs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            For CISOs and DPOs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/gdpr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GDPR (EU)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/iso-27001/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ISO 27001 (EU)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/nist-sp-800-171/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NIST SP 800-171
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Information Security
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Information Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/information-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/information-security/dod-enterprise-devsecops-reference-design-kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DoD Enterprise DevSecOps Reference Design
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Healthcare
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Healthcare
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/hslf-fs-201640/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HSLF-FS 2016:40 (SE)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/hipaa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HIPAA (US)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/mdr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MDR (EU)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Public sector
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Public sector
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/msbfs-20207/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MSBFS 2020:7 (SE)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    NIS2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            NIS2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/nis2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/kritis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KRITIS (DE)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/bsi-it-grundschutz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSI IT-Grundschutz (DE)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/controls/msbfs-20188/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MSBFS 2018:8 (SE)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_9" >
        
          
          <label class="md-nav__link" for="__nav_5_9" id="__nav_5_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Industrial control systems
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_9">
            <span class="md-nav__icon md-icon"></span>
            Industrial control systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/isa-iec-62443/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ISA/IEC 62443
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_10" >
        
          
          <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CISO Dashboards
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_10">
            <span class="md-nav__icon md-icon"></span>
            CISO Dashboards
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/audit-logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audit Logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup Dashboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/cryptography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cryptography Dashboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/intrusion-detection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intrusion Detection Dashboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/policy-as-code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy-as-Code Dashboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/network-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Security Dashboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/capacity-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Capacity Management (Kubernetes Status) Dashboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/vulnerability/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vulnerability Dashboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/log-review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Log Review
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/gdpr-art-17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How do I comply with GDPR Art. 17 Right to erasure ("right to be forgotten")?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/pdl-audit-logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How do I comply with HSLF-FS 2016:40 4 kap. 9 § Kontroll av åtkomst till uppgifter?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For Contributors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            For Contributors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributor-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architectural Decision Log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tech-radar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tech Radar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quality-criteria/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quality Criteria
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Release Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Cycle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/welkin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welkin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/kubespray/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welkin Kubespray
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/capi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welkin Cluster API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/postgres/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welkin PostgreSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/rabbitmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welkin RabbitMQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welkin Redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/jaeger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welkin Jaeger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/argocd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welkin Argo CD
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/managed-services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fully Managed Welkin
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/self-managed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support for Self-Managed Welkin
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/consulting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Consulting
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Official Training
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/legal/privacy-policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Privacy Policy
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
        </div>
      </div>
    </div>
  

  <!-- Table of contents -->
  
    
    <div
      class="md-sidebar md-sidebar--secondary"
      data-md-component="sidebar"
      data-md-type="toc"
      
    >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-context-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      System Context Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-air-gapped-welkin-apps" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring Air-gapped Welkin Apps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring Air-gapped Welkin Apps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container-images-and-registry-mirroring" class="md-nav__link">
    <span class="md-ellipsis">
      Container Images and Registry Mirroring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Container Images and Registry Mirroring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#migrating-images-from-a-running-environment-with-script" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating Images From a Running Environment with Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrating-images-manually" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating Images Manually
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-local-dns" class="md-nav__link">
    <span class="md-ellipsis">
      Node-local-dns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#falco" class="md-nav__link">
    <span class="md-ellipsis">
      Falco
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opensearch" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trivy" class="md-nav__link">
    <span class="md-ellipsis">
      Trivy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networkpolicies" class="md-nav__link">
    <span class="md-ellipsis">
      NetworkPolicies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-alerting-receiver" class="md-nav__link">
    <span class="md-ellipsis">
      Custom alerting receiver
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo" class="md-nav__link">
    <span class="md-ellipsis">
      Demo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>

          <br/>
          <div><img id="sidebar-welkin-logo" src="../../img/logos/Welkin_maskot.svg"></div>
        </div>
      </div>
    </div>
  

          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="welkin-in-air-gapped-network">Welkin in Air-gapped Network<a class="headerlink" href="#welkin-in-air-gapped-network" title="Permanent link">&para;</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Each air-gapped network is different. Therefore, this page should only be taken as a guideline, not as "works out-of-the-box instructions". Contact <a href="https://elastisys.com/self-managed/">Elastisys Support</a> if you need help.</p>
</div>
<div class="admonition elastisys-self-managed">
<p class="admonition-title">For Elastisys Self-Managed Customers</p>
<p>Please start by running <a href="../troubleshooting/#i-have-no-clue-where-to-start">these commands</a>.</p>
<p>If you are struggling, don't hesitate to <a href="https://elastisys.atlassian.net/servicedesk/customer/portals">file a ticket</a>.</p>
<p>You can run the following command from the <a href="https://github.com/elastisys/compliantkubernetes-apps">compliantkubernetes-apps</a> repository to collect diagnostic information that will help us support you.
Ensure that you have put fingerprints received from Elastisys in a file named <code>${CK8S_CONFIG_PATH}/diagnostics_receiver.gpg</code>.</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span>diagnostics<span class="w"> </span>&lt;wc<span class="p">|</span>sc&gt;
</code></pre></div>
<p><details><summary>Show more examples on using the diagnostics command</summary>
The command <code>ck8s diagnostics</code> can be provided with different flags to gather additional information from your environment, to see all available options run:</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span>diagnostics<span class="w"> </span>&lt;wc<span class="p">|</span>sc&gt;<span class="w"> </span>--help
</code></pre></div>
<p>Some example use cases:</p>
<ul>
<li>
<p>To include config files found in <code>CK8S_CONFIG_PATH</code>:</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span>diagnostics<span class="w"> </span>&lt;wc<span class="p">|</span>sc&gt;<span class="w"> </span>--include-config
</code></pre></div>
</li>
<li>
<p>To retrieve more information such as YAML manifests for resources in a specific namespace, in this example <code>ingress-nginx</code>:</p>
<div class="highlight"><pre><span></span><code>./bin/ck8s<span class="w"> </span>diagnostics<span class="w"> </span>&lt;wc<span class="p">|</span>sc&gt;<span class="w"> </span>namespace<span class="w"> </span>ingress-nginx
</code></pre></div>
</li>
<li>
<p>It is also possible to set which GPG keys should be used by setting <code>CK8S_PGP_FP</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">CK8S_PGP_FP</span><span class="o">=</span>&lt;gpg-fingerprint1&gt;,&lt;gpg-fingerprint2&gt;
./bin/ck8s<span class="w"> </span>diagnostics<span class="w"> </span>&lt;wc<span class="p">|</span>sc&gt;<span class="w"> </span>namespace<span class="w"> </span>ingress-nginx
</code></pre></div>
</li>
</ul>
</details>
<p>Please also provide us with your terminal in a text format.
We need to look both at the commands you typed and their output.</p>
</div>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<p>In an air-gapped network, machines are isolated from insecure networks such as the public Internet. Air-gapping is used for networks that handle highly confidential data such as military or governmental systems, or in life-critical systems, for example, in nuclear power plants or for medical equipment. This document provides guidelines on how to configure Welkin Apps to work inside an air-gapped network.</p>
<h2 id="system-context-diagram">System Context Diagram<a class="headerlink" href="#system-context-diagram" title="Permanent link">&para;</a></h2>
<p>The following is a generic system context diagram over an air-gapped network consisting of a Welkin Environment. The diagram shows the Platform Administrator Machine that has access to both the Internet and the air-gapped network. Inside the air-gapped network, Welkin Clusters can access other services residing on the same private network such as an object storage for long-term storage, a container registry mirror, DNS and NTP servers, etc.</p>
<p><img alt="Diagram" src="../../img/air-gapped.drawio.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>* For Certificate Provisioning, you may want to allow DNS01 or HTTP01 challenges to a public certificate authority, such as <a href="https://letsencrypt.org/">Let's Encrypt</a>. However, if you want the whole network to be truly air-gapped, then you need to figure out an air-gapped solution for PKI.</p>
</div>
<h2 id="configuring-air-gapped-welkin-apps">Configuring Air-gapped Welkin Apps<a class="headerlink" href="#configuring-air-gapped-welkin-apps" title="Permanent link">&para;</a></h2>
<p>These guidelines show how to configure Welkin Apps to work in an air-gapped network.
For setting up the Kubernetes layer, please refer to the <a href="https://kubespray.io/#/docs/operations/offline-environment">Kubespray air-gap installation documentation</a> or <a href="https://cluster-api.sigs.k8s.io/clusterctl/configuration.html?highlight=release#image-overrides">Cluster-API documentation</a> for further instructions.</p>
<p>This guide will assume that you have a Platform Administrator Machine that can access both the Internet and the air-gapped network over SSH, this includes SSH access to both the Cluster nodes and hosts for the different offline services described in the system context diagram above. This "Platform Administrator Machine" can be your local machine or a bastion host.</p>
<p>Start by initializing your Welkin Apps configuration (see the quickstart section <a href="https://github.com/elastisys/compliantkubernetes-apps?tab=readme-ov-file#quickstart">here</a> for more info on initializing and deploying Welkin Apps) with the <code>air-gapped</code> flavor by setting the <code>CK8S_FLAVOR</code> environment variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">CK8S_FLAVOR</span><span class="o">=</span>air-gapped
</code></pre></div>
<h3 id="container-images-and-registry-mirroring">Container Images and Registry Mirroring<a class="headerlink" href="#container-images-and-registry-mirroring" title="Permanent link">&para;</a></h3>
<p>All container images used for the Kubernetes layer and for Welkin Apps needs to be available in the air-gapped network. This can be done by setting up a private container registry (e.g. <code>Harbor</code>) that can act as a <a href="https://docs.docker.com/docker-hub/mirror/">registry mirror or registry cache</a>. But first these images need to be added to the private container registry. The following sections describes ways of getting images used by Welkin Apps.</p>
<h4 id="migrating-images-from-a-running-environment-with-script">Migrating Images From a Running Environment with Script<a class="headerlink" href="#migrating-images-from-a-running-environment-with-script" title="Permanent link">&para;</a></h4>
<p>There is <a href="https://kubespray.io/#/contrib/offline/README?id=manage-offline-container-imagessh">a useful script</a> in the upstream Kubespray repository that you can use to get all images from existing Welkin Clusters by simply pointing the <code>KUBECONFIG</code> environment variable to the correct Cluster(s). If possible it is recommended to use this script for migrating images to a container registry mirror.</p>
<h4 id="migrating-images-manually">Migrating Images Manually<a class="headerlink" href="#migrating-images-manually" title="Permanent link">&para;</a></h4>
<p>If getting images from a running Cluster is not desirable, use the following commands to get <strong>most</strong> of the images used in Welkin Apps:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">KUBE_VERSION</span><span class="o">=</span><span class="c1"># e.g. 1.27.5</span>
./bin/ck8s<span class="w"> </span>ops<span class="w"> </span>helmfile<span class="w"> </span>sc<span class="w"> </span>template<span class="w"> </span>--kube-version<span class="o">=</span><span class="nv">$KUBE_VERSION</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>yq4<span class="w"> </span><span class="s1">&#39;..|.image? | select(.)&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="w"> </span>&gt;<span class="w"> </span>images-sc.list
./bin/ck8s<span class="w"> </span>ops<span class="w"> </span>helmfile<span class="w"> </span>wc<span class="w"> </span>template<span class="w"> </span>--kube-version<span class="o">=</span><span class="nv">$KUBE_VERSION</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>yq4<span class="w"> </span><span class="s1">&#39;..|.image? | select(.)&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-u<span class="w"> </span>&gt;<span class="w"> </span>images-wc.list
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We use the word <strong>most</strong> here since some images can only be known after deployment, since some pods are created by operators. These images will need to be managed manually.</p>
</div>
<p>You can then copy over the images to the host running the container registry mirror, after which the images can be tagged and pushed to. To copy over images, you can store them as tarballs, for example, you can run the following if you have a container runtime installed such as <code>nerdctl</code>, <code>docker</code> or <code>podman</code> (see the note regarding using <code>docker</code> and <code>podman</code>):</p>
<div class="highlight"><pre><span></span><code><span class="nv">RUNTIME</span><span class="o">=</span>nerdctl
<span class="nv">REGISTRY</span><span class="o">=</span><span class="w"> </span><span class="c1"># set this to the public registry containing the image, e.g. ghcr.io</span>
<span class="nv">IMAGE_NAME</span><span class="o">=</span><span class="w"> </span><span class="c1"># include repository, image name and tag, e.g. aquasecurity/trivy-operator:0.17.1</span>
<span class="nv">IMAGE_FILE_NAME</span><span class="o">=</span>image_file.tar
sudo<span class="w"> </span><span class="si">${</span><span class="nv">RUNTIME</span><span class="si">}</span><span class="w"> </span>pull<span class="w"> </span><span class="si">${</span><span class="nv">REGISTRY</span><span class="si">}</span>/<span class="si">${</span><span class="nv">IMAGE_NAME</span><span class="si">}</span>
sudo<span class="w"> </span><span class="si">${</span><span class="nv">RUNTIME</span><span class="si">}</span><span class="w"> </span>save<span class="w"> </span>-o<span class="w"> </span><span class="si">${</span><span class="nv">IMAGE_FILE_NAME</span><span class="si">}</span>.tar<span class="w"> </span><span class="si">${</span><span class="nv">REGISTRY</span><span class="si">}</span>/<span class="si">${</span><span class="nv">IMAGE_NAME</span><span class="si">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be wary of images with digests as tags, as when saving the container image when using the <code>docker</code> or <code>podman</code> runtime and then loading it, the image will lose its digest (see issue discussing this <a href="https://github.com/moby/moby/issues/22011">here</a>). If you use this approach, you may need to override the digest or image tag used in the Welkin Apps configuration. Using a tool like <code>nerdctl</code> will however preserve the correct image digest.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If your Platform Administrator Machine has access to the air-gapped container registry mirror, you can use a tool like <a href="https://github.com/regclient/regclient"><code>regctl</code> or <code>regsync</code></a> which can help syncing images between repositories. This way, images will keep their digest and you do not have to save the images locally and move them to the air-gapped registry before pushing them.</p>
</div>
<p>Then copy the image tarballs to the container registry mirror host using <code>scp</code>. SSH to the host and load, tag and push the images:</p>
<div class="highlight"><pre><span></span><code><span class="nv">PRIVATE_REGISTRY</span><span class="o">=</span><span class="w"> </span><span class="c1"># set this to an air-gapped registry, e.g. registry.air-gapped.internal:5000</span>
sudo<span class="w"> </span><span class="si">${</span><span class="nv">RUNTIME</span><span class="si">}</span><span class="w"> </span>load<span class="w"> </span>-i<span class="w"> </span><span class="si">${</span><span class="nv">IMAGE_FILE_NAME</span><span class="si">}</span>
sudo<span class="w"> </span><span class="si">${</span><span class="nv">RUNTIME</span><span class="si">}</span><span class="w"> </span>tag<span class="w"> </span><span class="si">${</span><span class="nv">REGISTRY</span><span class="si">}</span>/<span class="si">${</span><span class="nv">IMAGE_NAME</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">PRIVATE_REGISTRY</span><span class="si">}</span>/<span class="si">${</span><span class="nv">IMAGE_NAME</span><span class="si">}</span>
sudo<span class="w"> </span><span class="si">${</span><span class="nv">RUNTIME</span><span class="si">}</span><span class="w"> </span>push<span class="w"> </span><span class="si">${</span><span class="nv">PRIVATE_REGISTRY</span><span class="si">}</span>/<span class="si">${</span><span class="nv">IMAGE_NAME</span><span class="si">}</span>
</code></pre></div>
<p>Configure the container registry mirror for the container runtime. If you are using Kubespray and <code>containerd</code> you can configure mirrors as follows:</p>
<!-- prettier-ignore-start -->

<div class="highlight"><pre><span></span><code><span class="nt">registry_addr</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;registry.air-gapped.internal&quot;</span>
<span class="nt">registry_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://registry.air-gapped.internal&quot;</span><span class="w"> </span><span class="c1"># change to http:// if not available over HTTPS</span>
<span class="nt">registry_insecure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># set to true if HTTP</span>

<span class="nt">containerd_registries_mirrors</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">registry_addr</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">mirrors</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">registry_host</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">        </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pull&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;resolve&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">skip_verify</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">registry_verify</span><span class="w"> </span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;docker.io&quot;</span>
<span class="w">    </span><span class="nt">mirrors</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">registry_host</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">        </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pull&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;resolve&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">skip_verify</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">registry_verify</span><span class="w"> </span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gcr.io&quot;</span>
<span class="w">    </span><span class="nt">mirrors</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">registry_host</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">        </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pull&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;resolve&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">skip_verify</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">registry_verify</span><span class="w"> </span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ghcr.io&quot;</span>
<span class="w">    </span><span class="nt">mirrors</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">registry_host</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">        </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pull&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;resolve&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">skip_verify</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">registry_verify</span><span class="w"> </span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;quay.io&quot;</span>
<span class="w">    </span><span class="nt">mirrors</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">registry_host</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">        </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pull&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;resolve&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">skip_verify</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">registry_verify</span><span class="w"> </span><span class="p p-Indicator">}}</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;registry.k8s.io&quot;</span>
<span class="w">    </span><span class="nt">mirrors</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">registry_host</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">        </span><span class="nt">capabilities</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;pull&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;resolve&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">skip_verify</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{{</span><span class="w"> </span><span class="nv">registry_verify</span><span class="w"> </span><span class="p p-Indicator">}}</span>
</code></pre></div>
<!-- prettier-ignore-end -->

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If using e.g. Harbor as private container registry mirror, you may run into issues with non-namespaced images (e.g. <code>registry.k8s.io/pause</code>) as this is currently not supported with Harbor. In Kubespray it is possible to override some images, such as the <code>pause</code> image by setting <code>pod_infra_image_repo: "{{ registry_addr }}/library/pause"</code> and pushing the <code>pause</code> image to the <code>library</code> namespace/project in the Harbor registry.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on your setup, it might not be possible to run <code>ck8s update-ips</code> unless you configure the Platform Administrator Machine to be able to resolve domains configured in the air-gapped DNS server, or use some sort of proxy. Otherwise, configure NetworkPolicies for apps manually in the <code>*-config.yaml</code> files.</p>
</div>
<p>Some of the apps needs special configurations to work properly in an air-gapped network, the following sections will describe how to configure these more closely. Some of these values will already be set to <code>set-me</code> if you used the <code>CK8S_FLAVOR=air-gapped</code> which you need to configure before deploying the apps, however, there are some additional configurations you can make which you might want or need to configure depending on your setup.</p>
<h3 id="node-local-dns">Node-local-dns<a class="headerlink" href="#node-local-dns" title="Permanent link">&para;</a></h3>
<p>If you have configured a DNS server inside the air-gapped network that you want to use for resolving domains used for services running inside the Clusters (e.g. <code>grafana.air-gapped.internal</code>), you can configure it as an additional forwarder for <code>node-local-dns</code> in <code>common-config.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">nodeLocalDns</span><span class="p">:</span>
<span class="w">  </span><span class="nt">customConfig</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<span class="w">    </span><span class="no">example.local:53 {  # &lt;- set the zone name of your air-gapped network here</span>
<span class="w">        </span><span class="no">log</span>
<span class="w">        </span><span class="no">errors {</span>
<span class="w">          </span><span class="no">consolidate 5m &quot;.* i/o timeout$&quot; warning</span>
<span class="w">        </span><span class="no">}</span>
<span class="w">        </span><span class="no">forward . 10.65.131.137 # &lt;- change this to match your air-gapped network</span>
<span class="w">        </span><span class="no">bind 169.254.20.10 10.233.0.3</span>
<span class="w">        </span><span class="no">loadbalance</span>
<span class="w">        </span><span class="no">cache 5</span>
<span class="w">        </span><span class="no">reload</span>
<span class="w">        </span><span class="no">}</span>
</code></pre></div>
<h3 id="falco">Falco<a class="headerlink" href="#falco" title="Permanent link">&para;</a></h3>
<p>Falco is configured by default to retrieve and update plugins, e.g. Falco rules, from the Internet. In an air-gapped network you can disable the Falco artifact installer to avoid this, and keep the Falco rules that are packaged with the Falco container image. To disable Falco artifact installer, configure the following in <code>common-config.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">falco</span><span class="p">:</span>
<span class="w">  </span><span class="nt">artifact</span><span class="p">:</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
<p>It is also possible to host Falco artifact indexes yourselves and configure Falco to point to the URL of these (see <a href="https://github.com/falcosecurity/falcoctl/blob/main/proposals/20220916-rules-and-plugin-distribution.md#index-file-overview">here</a> for an overview on falcoctl indexes):</p>
<div class="highlight"><pre><span></span><code><span class="nt">falco</span><span class="p">:</span>
<span class="w">  </span><span class="nt">artifact</span><span class="p">:</span>
<span class="w">    </span><span class="nt">install</span><span class="p">:</span>
<span class="w">      </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">customIndexes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fileserver.air-gapped.internal:8080/falcoctl/index.yaml</span>
</code></pre></div>
<p>The default Falco driver in Welkin is <code>module</code>. With this driver, Falco will attempt to download the driver from the internet, and if it fails to do so, it will build the module as a fallback, which would be the case in an air-gapped network. Unless you host driver modules yourself and configure Falco to use this file server instead:</p>
<div class="highlight"><pre><span></span><code><span class="nt">falco</span><span class="p">:</span>
<span class="w">  </span><span class="nt">driver</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">module</span>
<span class="w">    </span><span class="nt">module</span><span class="p">:</span>
<span class="w">      </span><span class="nt">repoURL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fileserver.air-gapped.internal:8080&quot;</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>With this setup it is <strong>your</strong> responsibility to ensure that any Falco modules, rules and/or plugins are kept up to date.</p>
</div>
<p>If nodes in the Clusters have a kernel version &gt;=5.8, you can use <code>modern-bpf</code> instead to avoid Falco having to download drivers from the Internet, as everything is already embedded into Falco (as long as this is supported, see requirements <a href="https://falco.org/docs/event-sources/kernel/#requirements">here</a>):</p>
<div class="highlight"><pre><span></span><code><span class="nt">falco</span><span class="p">:</span>
<span class="w">  </span><span class="nt">driver</span><span class="p">:</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">modern-bpf</span>
</code></pre></div>
<h3 id="opensearch">OpenSearch<a class="headerlink" href="#opensearch" title="Permanent link">&para;</a></h3>
<p>Welkin is configured to store OpenSearch data in Object storage which is configured with plugins. Normally, OpenSearch attempts to download plugins from the Internet. In an air-gapped network, you can download plugins for OpenSearch manually and host them on a file server inside the air-gapped network. To download the S3 plugin run:</p>
<div class="highlight"><pre><span></span><code><span class="nv">OPENSEARCH_VERSION</span><span class="o">=</span><span class="m">2</span>.8.0<span class="w">  </span><span class="c1"># set the opensearch version of the cluster</span>
wget<span class="w"> </span><span class="s2">&quot;https://artifacts.opensearch.org/releases/plugins/repository-s3/</span><span class="si">${</span><span class="nv">OPENSEARCH_VERSION</span><span class="si">}</span><span class="s2">/repository-s3-</span><span class="si">${</span><span class="nv">OPENSEARCH_VERSION</span><span class="si">}</span><span class="s2">.zip&quot;</span>
</code></pre></div>
<p>To configure OpenSearch to download the S3 plugin from a file server instead of downloading from the Internet, set the following in <code>sc-config.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">opensearch</span><span class="p">:</span>
<span class="w">  </span><span class="nt">plugins</span><span class="p">:</span>
<span class="w">    </span><span class="nt">installExternalObjectStoragePlugin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">additionalPlugins</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fileserver.air-gapped.internal:8080/repository-s3-${OPENSEARCH_VERSION}.zip</span>
</code></pre></div>
<h3 id="trivy">Trivy<a class="headerlink" href="#trivy" title="Permanent link">&para;</a></h3>
<p>Trivy checks for vulnerabilities from a vulnerability database as well as a Java index database which are usually downloaded directly from GitHub (<code>ghcr.io</code>). In an air-gapped network, you can download these databases manually and push them to a private registry inside the air-gapped network. Please <a href="https://aquasecurity.github.io/trivy/v0.47/docs/advanced/air-gap/#download-the-vulnerability-database">read the air-gapped documentation for Trivy</a> on how to download and copy over this database. The tool <a href="https://oras.land/docs/"><code>oras</code></a> can be useful for working with and managing OCI repositories.</p>
<p>Once the databases are available in the air-gapped private-registry, you need to configure the following variables in <code>common-config.yaml</code> for Trivy to download from the private registry:</p>
<div class="highlight"><pre><span></span><code><span class="nt">trivy</span><span class="p">:</span>
<span class="w">  </span><span class="nt">scanner</span><span class="p">:</span>
<span class="w">    </span><span class="nt">offlineScanEnabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">dbRegistry</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.air-gapped.internal</span>
<span class="w">    </span><span class="nt">dbRepository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasecurity/trivy-db</span>
<span class="w">    </span><span class="nt">dbRepositoryInsecure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"> </span><span class="c1"># set to true if the private registry is not configured with HTTPS</span>
<span class="w">    </span><span class="nt">javaDbRegistry</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.air-gapped.internal</span>
<span class="w">    </span><span class="nt">javaDbRepository</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aquasecurity/trivy-java-db</span>

<span class="w">    </span><span class="c1"># add registries that should be mirrored to private registry</span>
<span class="w">    </span><span class="nt">registry</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mirror</span><span class="p">:</span>
<span class="w">        </span><span class="s">&quot;docker.io&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.air-gapped.internal</span>
<span class="w">        </span><span class="s">&quot;gcr.io&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.air-gapped.internal</span>
<span class="w">        </span><span class="s">&quot;ghcr.io&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.air-gapped.internal</span>
<span class="w">        </span><span class="s">&quot;index.docker.io&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.air-gapped.internal</span>
<span class="w">        </span><span class="s">&quot;quay.io&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.air-gapped.internal</span>
<span class="w">        </span><span class="s">&quot;registry.k8s.io&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">registry.air-gapped.internal</span>

<span class="w">    </span><span class="c1"># if authorization is required to the private registry, create a pull</span>
<span class="w">    </span><span class="c1"># secret in the monitoring namespace and configure the secret name</span>
<span class="w">    </span><span class="nt">imagePullSecret</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;pull-secret&quot;</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>With this setup it is <strong>your</strong> responsibility to ensure that vulnerability databases are kept up to date.</p>
</div>
<h3 id="networkpolicies">NetworkPolicies<a class="headerlink" href="#networkpolicies" title="Permanent link">&para;</a></h3>
<p>A note about configuring NetworkPolicies, when using self-hosted file servers for the different services, remember to configure NetworkPolicies accordingly, i.e. if a self-hosted file server runs on a different port than 443, you will need to override it in the configuration for each respective service, e.g. for OpenSearch to get plugins from <code>fileserver.air-gapped.internal:8080</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">networkPolicies</span><span class="p">:</span>
<span class="w">  </span><span class="nt">opensearch</span><span class="p">:</span>
<span class="w">    </span><span class="nt">plugins</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ips</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.65.131.137/32</span><span class="w"> </span><span class="c1"># set this to the IP of fileserver.air-gapped.internal</span>
<span class="w">      </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w"> </span><span class="c1"># the file-server is hosted on port 8080</span>
</code></pre></div>
<h3 id="custom-alerting-receiver">Custom alerting receiver<a class="headerlink" href="#custom-alerting-receiver" title="Permanent link">&para;</a></h3>
<p>It is possible to configure your own alerting receivers for Alertmanager, which you can use to configure alerting to a on-call service that is available in your air-gapped network. The following shows a simplified example on how to configure a custom email receiver in <code>sc-config.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">alerts</span><span class="p">:</span>
<span class="w">  </span><span class="nt">alertsTo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">email</span>
<span class="w">  </span><span class="nt">customReceivers</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;email&quot;</span>
<span class="w">      </span><span class="nt">email_configs</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="w">          </span><span class="nt">from</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;prometheus@example.com&quot;</span>
<span class="w">          </span><span class="nt">require_tls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">          </span><span class="nt">send_resolved</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<h2 id="demo">Demo<a class="headerlink" href="#demo" title="Permanent link">&para;</a></h2>
<p>Following are some screenshots of an air-gapped Welkin Environment, accessing Service Endpoints on the local air-gapped domain by using a <a href="https://en.wikipedia.org/wiki/SOCKS">SOCKS proxy</a> in Firefox over an SSH tunnel. Accessing Grafana Dashboards:</p>
<p><img alt="Air-gapped Grafana" src="../../img/air-gapped-grafana.png" /></p>
<p>Signing in with Dex will redirect to the Dex Service Endpoint for authentication (in this case a static user is used):</p>
<p><img alt="Air-gapped Dex" src="../../img/air-gapped-dex.png" /></p>
<p>Checking the endpoint of the <a href="https://github.com/elastisys/welkin/tree/main/user-demo">user demo</a> application:</p>
<p><img alt="Air-gapped User Demo" src="../../img/air-gapped-demo.png" /></p>
<p>Seeing HTTP metrics for the <code>/users</code> endpoint of the user demo in Grafana Dashboards:</p>
<p><img alt="Air-gapped User Demo metrics in Grafana" src="../../img/air-gapped-grafana-demo.png" /></p>
<p>Seeing logs from the user demo pods in OpenSearch Dashboards:</p>
<p><img alt="Air-gapped User Demo logs in OpenSearch Dashboards" src="../../img/air-gapped-opensearch-demo.png" /></p>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Air_gap_(networking)">Air gap (networking) on Wikipedia</a></li>
<li><a href="https://kubespray.io/#/docs/operations/offline-environment">Kubespray offline environment documentation</a></li>
</ul>







  
  



  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        Was this page helpful?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Thanks for your feedback!
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Thanks for your feedback! Help us improve this page by <a href="https://github.com/elastisys/welkin/issues/new/choose" target="_blank">filing an issue</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../on-prem-standard/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Standard Template for on-prem Environment">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Standard Template for on-prem Environment
              </div>
            </div>
          </a>
        
        
          
          <a href="../configure/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © Elastisys AB <br/> Elastisys has the following registered trademarks in Europe and/or other countries: Elastisys Welkin®. <br/> Elastisys has registrations pending or trademarks in use for the following marks in Europe and/or other countries: the Welkin logo and Welkin mascot. <br/> The Linux Foundation has the following registered trademarks in the United States and/or other countries: Certified Kubernetes®, containerd®, fluentd®, Helm®, Istio®, K8s®, Kubernetes®, Prometheus®, PromQL®, Rook®, The Linux Foundation®. <br/> The Linux Foundation has registrations pending or trademarks in use for the following marks in the United States and/or other countries: Argo™, CoreDNS™, Falco™, Harbor™, Jaeger™, Linux Foundation™, OpenTelemetry™, OpenTracing™, Open Policy Agent™, Tekton™, Thanos™. <br/> Postgres and PostgreSQL and the Elephant Logo (Slonik) are all registered trademarks of the PostgreSQL Community Association of Canada. <br/> Redis is a trademark of Redis Ltd. Any rights therein are reserved to Redis Ltd. Any use by the Welkin project is for referential purposes only and does not indicate any sponsorship, endorsement or affiliation between Redis and Welkin project. <br/> RabbitMQ is a trademark of VMware, Inc. in the U.S. and other countries. <br/> TimescaleDB and the EON mascot are trademarks of <a href="https://www.timescale.com/">Timescale, Inc.</a> <br/> FerretDB® is a registered trademark of FerretDB, Inc. FerretDB Inc. is not affiliated, associated, authorized, endorsed by, or in any way officially connected with MongoDB Inc., or any of its subsidiaries or its affiliates. <br/> MongoDB, Mongo, and the leaf logo are registered trademarks of MongoDB, Inc. <br/> Keycloak™ is a trademark of Red Hat Inc. <br/> OpenSearch is a registered trademark of Amazon Web Services. <br/> NGINX is a registered trademark of F5 Inc.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tabs.link", "navigation.footer", "navigation.top"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/feedback.js"></script>
      
    
  </body>
</html>